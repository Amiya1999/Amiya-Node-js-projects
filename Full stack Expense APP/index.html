<!DOCTYPE html>
<html>
    <head>
        <title>Expense Tracker</title> 
        <style>
          body {
  font-family: Arial, sans-serif;
  margin: 0;
  padding: 0;
}

.container {
  max-width: 600px;
  margin: 0 auto;
  padding: 20px;
}

h1 {
  font-size: 36px;
  text-align: center;
  margin-bottom: 20px;
}

form {
  margin-bottom: 20px;
}

label {
  display: block;
  margin-bottom: 10px;
  font-size: 18px;
}

input[type="text"],
input[type="number"] {
  border: 1px solid #ccc;
  padding: 10px;
  width: 100%;
  font-size: 16px;
  margin-bottom: 20px;
}

button[type="submit"] {
  background-color: #4CAF50;
  color: white;
  padding: 10px 20px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

button[type="submit"]:hover {
  background-color: #45a049;
}

ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

li {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
  padding: 10px;
  border: 1px solid #ccc;
}

li span {
  font-size: 18px;
}

li button {
  background-color: #f44336;
  color: white;
  border: none;
  padding: 10px 20px;
  border-radius: 4px;
  cursor: pointer;
  margin-left: 10px;
}

li button:hover {
  background-color: #d32f2f;
}

#total-expenses {
  font-size: 24px;
  text-align: right;
  margin-top: 20px;
}

        </style>
        <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
        <style>
          label {
                display: block;
                margin-bottom: 10px;
            }
        </style>
     </head>
    <body>
        <div class="container">
            <h1>Expense Tracker</h1>
            <form>
              <label for="expense">Expense Name:</label>
              <input type="text" id="expense" name="expense" required>
              <label for="amount">Expense Amount:</label>
              <input type="number" id="amount" name="amount" required>
              <button type="submit" id="add-expense">Add Expense</button>
            </form>
            <ul id="expense-list">EXPENSES</ul>
            <div id="total-expenses"></div>
          </div>
          <script>
            const form = document.querySelector('form');
            const expenseList = document.getElementById('expense-list');
            const totalExpenses = document.getElementById('total-expenses');
            let expenses = [];
            let editingExpense = null;
            
            form.addEventListener('submit', event => {
              event.preventDefault();
              const formData = new FormData(form);
              const expenseName = formData.get('expense');
              const expenseAmount = formData.get('amount');
              if (editingExpense) {
                // Editing an existing expense
                const obj = {
                  expense: expenseName,
                  amount: expenseAmount
                }
                axios.put(`http://localhost:5000/expense/${editingExpense.id}`, obj)
                  .then(response => {
                    const data = response.data;
                    const index = expenses.findIndex(expense => expense.id === data.id);
                    expenses[index] = data;
                    renderExpenses();
                    editingExpense = null;
                    form.reset();
                  })
                  .catch(error => console.error(error));
              } else {
                // Adding a new expense
                const obj = {
                  expense: expenseName,
                  amount: expenseAmount
                }
                axios.post('http://localhost:5000/expense', obj)
                  .then(response => {
                    const data = response.data;
                    expenses.push(data);
                    renderExpenses();
                    form.reset();
                  })
                  .catch(error => console.error(error));
              }
            });
            
            function renderExpenses() {
  expenseList.innerHTML = '';
  let total = 0;
  expenses.forEach(expense => {
    const expenseItem = document.createElement('li');
    const expenseName = document.createElement('span');
    const expenseAmount = document.createElement('span');
    const editButton = document.createElement('button');
    const deleteButton = document.createElement('button');
    expenseName.textContent = expense.expense;
    expenseAmount.textContent = expense.amount;
    editButton.textContent = 'Edit';
    deleteButton.textContent = 'Delete';
    editButton.addEventListener('click', () => {
      editingExpense = expense;
      document.getElementById('expense').value = expense.expense;
      document.getElementById('amount').value = expense.amount;
    });
    deleteButton.addEventListener('click', () => {
      if (confirm('Are you sure you want to delete this expense?')) {
        axios.delete(`http://localhost:5000/expense/${expense.id}`)
          .then(() => {
            const index = expenses.findIndex(exp => exp.id === expense.id);
            expenses.splice(index, 1);
            renderExpenses();
          })
          .catch(error => console.error(error));
      }
    });
    expenseItem.appendChild(expenseName);
    expenseItem.appendChild(expenseAmount);
    expenseItem.appendChild(editButton);
    expenseItem.appendChild(deleteButton);
    expenseList.appendChild(expenseItem);
    total += parseFloat(expense.amount);

    // Update the list item for the edited expense, if it is in the list
    if (editingExpense && expense.id === editingExpense.id) {
      expenseName= editingExpense.expense;
      expenseAmount = editingExpense.amount;
    }
  });
  totalExpenses.textContent = `Total Expenses: $${total}`;
}

            
            axios.get('http://localhost:5000/expenses')
              .then(response => {
                expenses = response.data;
                renderExpenses();
              })
              .catch(error => console.error(error));
          </script>
          
    </body>
</html>
